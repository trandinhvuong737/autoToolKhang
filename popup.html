<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Batch Processor</title>
  <style>
    :root {
      --bg: #f7fafd;
      --card: #fff;
      --card-2: #f2f6fa;
      --text: #1a2330;
      --muted: #7a8599;
      --primary: #2563eb;
      --primary-600: #1746a2;
      --border: #e3e8ef;
      --success: #22c55e;
      --warning: #f59e0b;
    }
    html, body { margin: 0; padding: 0; }
    body {
      width: 340px;
      padding: 18px 12px 16px 12px;
      background: var(--bg);
      color: var(--text);
      font: 15px/1.6 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      letter-spacing: 0.1px;
    }
    .container { display: flex; flex-direction: column; gap: 16px; }
    .title { margin: 0; font-size: 20px; font-weight: 800; letter-spacing: .2px; color: var(--primary-600); }
    .hint { margin: 0; color: var(--muted); font-size: 13px; }

    /* Button */
    .btn {
      display: inline-flex; align-items: center; justify-content: center;
      border: none; border-radius: 12px; cursor: pointer;
      min-height: 44px; padding: 0 18px; font-weight: 700; font-size: 15px;
      letter-spacing: .2px; background: var(--primary); color: #fff;
      box-shadow: 0 2px 8px 0 rgba(37,99,235,0.07);
      transition: background .15s, box-shadow .15s, transform .05s, opacity .15s;
      user-select: none;
    }
    .btn:active:not(:disabled) { transform: translateY(1px); }
    .btn-primary { background: var(--primary); color: white; }
    .btn-primary:hover:not(:disabled) { background: var(--primary-600); }
    .btn:disabled { opacity: .5; cursor: not-allowed; }
    #stopButton {
      background: #ef4444;
      color: #fff;
      margin-left: 8px;
    }
    #stopButton:hover:not(:disabled) { background: #b91c1c; }
    #stopButton:active:not(:disabled) { background: #991b1b; }

    /* Status */
    .status {
      padding: 10px 12px; border-radius: 10px; border: 1px solid var(--border);
      background: var(--card-2);
      color: var(--muted); font-size: 14px;
      margin-top: 2px;
    }
    .status-ok { color: var(--success); }
    .status-warn { color: var(--warning); }

    /* Details (config card) */
    details.config { border-radius: 12px; overflow: hidden; border: 1px solid var(--border); background: var(--card-2); }
    details.config > summary {
      list-style: none; cursor: pointer; padding: 14px 16px; font-weight: 700; color: var(--primary-600);
      display: flex; align-items: center; gap: 8px; position: relative; font-size: 15px;
    }
    details.config > summary::-webkit-details-marker { display: none; }
    details.config > summary::after {
      content: '\25BC'; font-size: 12px; color: var(--muted); margin-left: auto; transition: transform .15s;
    }
    details.config[open] > summary::after { transform: rotate(180deg); }
    .config-card { padding: 14px 16px 16px; border-top: 1px solid var(--border); }
    .config-form { display: flex; flex-direction: column; gap: 14px; }
    .divider { border: none; border-top: 1px solid var(--border); margin: 8px 0; }

    /* Fields */
    label { display: flex; flex-direction: column; gap: 6px; color: var(--text); font-weight: 600; font-size: 14px; }
    label small { font-weight: 400; color: var(--muted); margin-top: -2px; }
    input[type="text"], input[type="email"], input[type="number"], input[type="date"], textarea, select {
      width: 100%; box-sizing: border-box; border-radius: 10px; border: 1.5px solid var(--border);
      background: #fff; color: var(--text); padding: 10px 12px; outline: none;
      transition: border-color .15s, box-shadow .15s; font-size: 15px;
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
    }
    input[type="date"]::-webkit-input-placeholder { color: #b6c2d6; }
    input[type="date"]::-moz-placeholder { color: #b6c2d6; }
    input[type="date"]:-ms-input-placeholder { color: #b6c2d6; }
    input[type="date"]::placeholder { color: #b6c2d6; }
    input[type="date"]:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37,99,235,.10);
    }
    select {
      cursor: pointer;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%237a8599'%3E%3Cpath d='M4 6l4 4 4-4'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 18px;
      padding-right: 38px;
    }
    input::placeholder, textarea::placeholder { color: #b6c2d6; }
    textarea { resize: vertical; min-height: 64px; }
    input:focus, textarea:focus, select:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(37,99,235,.10); }

    /* Radio groups */
    .radio-group { display: flex; flex-wrap: wrap; gap: 10px 16px; align-items: center; }
    .radio-group > label { flex-direction: row; align-items: center; gap: 8px; font-weight: 500; font-size: 14px; }
    .radio-title { font-weight: 700; margin: 8px 0 2px; font-size: 14px; }

    /* Subsection */
    .subsection-title {
      font-weight: 800;
      margin: 16px 0 10px;
      color: var(--primary);
      font-size: 15px;
      padding-bottom: 4px;
      border-bottom: 1px solid var(--border);
    }
    .subsection-title:first-child { margin-top: 0; }
    /* Misc */
    #startButton { background: var(--primary); }
    #startButton:hover:not(:disabled) { background: var(--primary-600); }
    #startButton:active:not(:disabled) { background: #0e2e6e; }
    #failedLinksContainer details.config > summary { color: #ef4444; }
    #failedLinksContainer .btn { background: #fff0f0; color: #ef4444; border: 1px solid #ef4444; }
    #failedLinksContainer .btn:hover { background: #ffeaea; }
  </style>
  
</head>
<body>
  <div class="container">
    <h3 class="title">Äá»“ ChÆ¡i</h3>
    <p class="hint">Äáº£m báº£o báº¡n Ä‘ang á»Ÿ trÃªn trang cÃ³ danh sÃ¡ch liÃªn káº¿t.</p>
    
    <!-- Scan mode selection -->
    <label style="margin-bottom: 8px;">
      <span style="font-weight: 600; color: var(--text); font-size: 12px;">Cháº¿ Ä‘á»™ quÃ©t liÃªn káº¿t</span>
      <small style="color: var(--muted); display: block; margin-top: 4px; margin-bottom: 6px;">
        Chá»n "PhÃ¢n trang" náº¿u danh sÃ¡ch link náº±m trÃªn nhiá»u trang.
      </small>
      <select id="scanModeInput" style="font-weight: 600;">
        <option value="normal">BÃ¬nh thÆ°á»ng (1 trang)</option>
        <option value="paginated">PhÃ¢n trang (nhiá»u trang)</option>
      </select>
    </label>
    <label style="margin-bottom: 8px;">
      <span style="font-weight: 600; color: var(--text); font-size: 12px;">Sá»‘ lÆ°á»£ng tab má»Ÿ cÃ¹ng lÃºc</span>
      <small style="color: var(--muted); display: block; margin-top: 4px; margin-bottom: 6px;">
        ğŸ’¡ CÃ³ thá»ƒ tÃ¹y chá»‰nh tá»« 1-50 tabs.
      </small>
      <input id="batchSizeInput" type="number" min="1" max="50" value="10" placeholder="10" style="font-weight: 600;">
    </label>
    
    <label style="margin-bottom: 8px;">
      <span style="font-weight: 600; color: var(--text); font-size: 12px;">Thá»i gian chá» tá»‘i Ä‘a má»—i tab (giÃ¢y)</span>
      <small style="color: var(--muted); display: block; margin-top: 4px; margin-bottom: 6px;">
        â±ï¸ Tab quÃ¡ thá»i gian nÃ y sáº½ bá»‹ Ä‘Ã³ng vÃ  thá»­ láº¡i.
      </small>
      <input id="tabTimeoutInput" type="number" min="60" max="600" step="30" value="180" placeholder="180" style="font-weight: 600;">
    </label>
    
    <label style="margin-bottom: 8px;">
      <span style="font-weight: 600; color: var(--text); font-size: 12px;">Thá»i gian chá» CAPTCHA giáº£i (giÃ¢y)</span>
      <small style="color: var(--muted); display: block; margin-top: 4px; margin-bottom: 6px;">
        ğŸ¤– Chá» extension 2Captcha giáº£i CAPTCHA.
      </small>
      <input id="captchaTimeoutInput" type="number" min="30" max="300" step="10" value="120" placeholder="120" style="font-weight: 600;">
    </label>
    
    <!-- Custom links input -->
    <details class="config" style="margin-bottom: 8px;">
      <summary style="color: var(--primary); font-size: 13px;">ğŸ”— Danh sÃ¡ch links tÃ¹y chá»‰nh (tÃ¹y chá»n)</summary>
      <div style="padding: 10px 12px; border-top: 1px solid var(--border);">
        <label style="margin-bottom: 8px;">
          <span style="font-weight: 600; color: var(--text); font-size: 12px;">Nháº­p danh sÃ¡ch links (má»—i link 1 dÃ²ng)</span>
          <small style="color: var(--muted); display: block; margin-top: 4px; margin-bottom: 6px;">
            ğŸ’¡ <strong>Äá»ƒ trá»‘ng</strong> = trÃ­ch xuáº¥t links tá»« trang hiá»‡n táº¡i<br>
            ğŸ“ <strong>CÃ³ links</strong> = chá»‰ cháº¡y vá»›i list nÃ y (bá» qua trÃ­ch xuáº¥t)
          </small>
          <textarea id="customLinks" rows="6" placeholder="https://example.com/page1&#10;https://example.com/page2&#10;https://example.com/page3" style="font-family: 'Courier New', monospace; font-size: 11px; line-height: 1.6;"></textarea>
        </label>
        <div style="display: flex; gap: 8px; margin-top: 8px;">
          <button id="clearLinksBtn" class="btn" style="flex: 1; background: var(--card-2); border: 1px solid var(--border); font-size: 11px;">ğŸ—‘ï¸ XÃ³a</button>
          <button id="countLinksBtn" class="btn" style="flex: 1; background: var(--card-2); border: 1px solid var(--border); font-size: 11px;">ğŸ“Š Äáº¿m</button>
        </div>
        <div id="linkCount" style="margin-top: 8px; padding: 6px 10px; background: var(--card); border-radius: 6px; font-size: 11px; color: var(--muted); text-align: center; display: none;"></div>
      </div>
    </details>
    
    <!-- Failed links display -->
    <div id="failedLinksContainer" style="display: none; margin-top: 8px;">
      <details class="config">
        <summary style="color: #dc3545; font-weight: 600;">âŒ LiÃªn káº¿t tháº¥t báº¡i (<span id="failedCount">0</span>)</summary>
        <div style="background: #1a1212; border: 1px solid #4a2020; border-radius: 8px; padding: 10px; margin-top: 8px; max-height: 200px; overflow-y: auto;">
          <ul id="failedLinksList" style="margin: 0; padding: 0 0 0 20px; font-size: 11px; color: #ff9999; line-height: 1.8;">
            <!-- Failed links will be inserted here -->
          </ul>
          <button id="copyFailedLinks" class="btn" style="width: 100%; margin-top: 8px; background: #4a2020; color: #ff9999; font-size: 11px;">ğŸ“‹ Copy danh sÃ¡ch</button>
        </div>
      </details>
    </div>
    
    <details class="config" style="margin-top:4px;">
      <summary>Cáº¥u hÃ¬nh Ä‘iá»n form (tÃ¹y chá»n)</summary>
      <div class="config-card">
        <div style="background: #1a2847; border: 1px solid #2d4573; border-radius: 8px; padding: 10px 12px; margin-bottom: 12px;">
          <div style="font-size: 12px; color: #7e8ba8; line-height: 1.5;">
            ğŸ’¡ <strong style="color: #9aa4c1;">LÆ°u Ã½:</strong> CÃ¡c trÆ°á»ng quá»‘c gia cÃ³ thá»ƒ nháº­p:
            <ul style="margin: 6px 0 0 20px; padding: 0; font-size: 11px;">
              <li>MÃ£ 2 kÃ½ tá»±: <code style="background: #0b1226; padding: 2px 6px; border-radius: 4px; color: #6eb5ff;">VN</code>, <code style="background: #0b1226; padding: 2px 6px; border-radius: 4px; color: #6eb5ff;">US</code>, <code style="background: #0b1226; padding: 2px 6px; border-radius: 4px; color: #6eb5ff;">SG</code></li>
              <li>TÃªn Ä‘áº§y Ä‘á»§: <code style="background: #0b1226; padding: 2px 6px; border-radius: 4px; color: #6eb5ff;">Vietnam</code>, <code style="background: #0b1226; padding: 2px 6px; border-radius: 4px; color: #6eb5ff;">United States</code></li>
            </ul>
          </div>
        </div>
        <div class="config-form">
      <!-- <div>
        <div class="radio-title">Cháº¿ Ä‘á»™ phÃ¡t triá»ƒn</div>
        <div class="radio-group">
          <label><input type="checkbox" id="cfg_devMode"> DEV mode (má»Ÿ 1 tab, khÃ´ng tá»± Ä‘Ã³ng)</label>
        </div>
      </div> -->
      <!-- ThÃ´ng tin cÆ¡ báº£n -->
      <div class="subsection-title">ğŸ“‹ ThÃ´ng tin cÆ¡ báº£n</div>
      <label>
        TÃªn cÃ´ng ty khÃ¡ch hÃ ng cuá»‘i *
        <input id="cfg_endCustomerCompanyName" type="text" placeholder="ACME Co" />
      </label>
      
      <hr class="divider" />
      
      <!-- ThÃ´ng tin tÃ i khoáº£n & kinh doanh -->
      <div class="subsection-title">ğŸ’¼ ThÃ´ng tin tÃ i khoáº£n</div>
      <label>
        Website
        <input id="cfg_website" type="text" placeholder="https://example.com" />
      </label>
      <label>
        Tá»« khÃ³a máº«u *
        <input id="cfg_sampleKeywords" type="text" placeholder="quáº§n Ã¡o, thá»i trang" />
      </label>
      
      <div>
        <div class="radio-title">Sá»‘ lÆ°á»£ng tÃ i khoáº£n *</div>
        <div class="radio-group">
          <label><input type="radio" name="cfg_accountCount" value="single_account" id="cfg_single"> Má»™t tÃ i khoáº£n</label>
          <label><input type="radio" name="cfg_accountCount" value="multiple_non_mcc" id="cfg_multi"> Nhiá»u (khÃ´ng MCC)</label>
          <label><input type="radio" name="cfg_accountCount" value="mcc_account" id="cfg_mcc"> TÃ´i lÃ  MCC</label>
        </div>
      </div>
      
      <div>
        <div class="radio-title">Báº¡n Ä‘ang quáº£ng cÃ¡o cho? *</div>
        <div class="radio-group">
          <label><input type="radio" name="cfg_ownerOrEmp" value="yes" id="cfg_owner_yes"> Doanh nghiá»‡p riÃªng</label>
          <label><input type="radio" name="cfg_ownerOrEmp" value="no" id="cfg_owner_no"> KhÃ´ng pháº£i</label>
          <label><input type="radio" name="cfg_ownerOrEmp" value="account_manager" id="cfg_manager"> Quáº£n lÃ½ cho khÃ¡ch</label>
          <label><input type="radio" name="cfg_ownerOrEmp" value="affiliate" id="cfg_affiliate"> ÄÆ¡n vá»‹ liÃªn káº¿t</label>
          <label><input type="radio" name="cfg_ownerOrEmp" value="other" id="cfg_other"> KhÃ¡c</label>
        </div>
      </div>
      
      <label>
        Náº¿u chá»n "KhÃ¡c", mÃ´ táº£
        <input id="cfg_ownerOrEmpOther" type="text" placeholder="VD: Äá»‘i tÃ¡c phÃ¡p lÃ½" />
      </label>
      
      <label>
        Ai thanh toÃ¡n cho tÃ i khoáº£n? *
        <textarea id="cfg_whoPays" rows="2" placeholder="VD: KhÃ¡ch hÃ ng thanh toÃ¡n trá»±c tiáº¿p"></textarea>
      </label>
      
      <label>
        MÃ´ táº£ doanh nghiá»‡p *
        <textarea id="cfg_businessDesc" rows="2" placeholder="VD: ChÃºng tÃ´i bÃ¡n quáº§n Ã¡o trá»±c tuyáº¿n"></textarea>
      </label>
      
      <label>
        ThÃ´ng tin quan há»‡ Ä‘áº¡i lÃ½-khÃ¡ch hÃ ng
        <textarea id="cfg_clientAgencyRelationship" rows="2" placeholder="MÃ´ táº£ má»‘i quan há»‡ vá»›i khÃ¡ch hÃ ng"></textarea>
      </label>
      
      <label>
        ThÃ´ng tin chá»§ sá»Ÿ há»¯u miá»n
        <textarea id="cfg_domainOwnership" rows="2" placeholder="Ai sá»Ÿ há»¯u cÃ¡c miá»n Ä‘ang quáº£ng cÃ¡o"></textarea>
      </label>
      
      <hr class="divider" />
      
      <!-- ThÃ´ng tin thanh toÃ¡n -->
      <div class="subsection-title">ğŸ’³ ThÃ´ng tin thanh toÃ¡n</div>
      <label>
        Äá»‹a chá»‰ Ä‘Æ°á»ng phá»‘ *
        <input id="cfg_billingStreet" type="text" placeholder="123 ÄÆ°á»ng ABC" />
      </label>
      <label>
        MÃ£ bÆ°u chÃ­nh *
        <input id="cfg_billingZip" type="text" placeholder="700000" />
      </label>
      <label>
        ThÃ nh phá»‘ *
        <input id="cfg_billingTown" type="text" placeholder="Há»“ ChÃ­ Minh" />
      </label>
      <label>
        Quá»‘c gia thanh toÃ¡n *
        <input id="cfg_billingCountryCode" type="text" placeholder="VN hoáº·c Vietnam" />
        <small style="color: #666; font-size: 11px;">ğŸ’¡ Nháº­p mÃ£ 2 kÃ½ tá»± (VN) hoáº·c tÃªn Ä‘áº§y Ä‘á»§ (Vietnam)</small>
      </label>
      
      <label>
        HÃ¬nh thá»©c thanh toÃ¡n *
        <select id="cfg_paymentOption">
          <option value="">-- Chá»n --</option>
          <option value="payment_credit">Tháº» tÃ­n dá»¥ng/ghi ná»£</option>
          <option value="payment_invoicing">Láº­p hÃ³a Ä‘Æ¡n</option>
          <option value="payment_directdebit">Ghi ná»£ trá»±c tiáº¿p</option>
          <option value="payment_banktrans">Chuyá»ƒn khoáº£n ngÃ¢n hÃ ng</option>
          <option value="payment_grants">Google Ad Grants</option>
          <option value="payment_other">KhÃ¡c</option>
        </select>
      </label>
      
      <label>
        NgÃ y thanh toÃ¡n gáº§n nháº¥t
        <input id="cfg_lastPaymentDate" type="date" placeholder="mm/dd/yyyy" />
      </label>
      
      <label>
        Quá»‘c gia phá»¥c vá»¥ *
        <input id="cfg_countriesBusinessServe" type="text" placeholder="VN hoáº·c Vietnam" />
        <small style="color: #666; font-size: 11px;">ğŸ’¡ Nháº­p mÃ£ 2 kÃ½ tá»± (VN) hoáº·c tÃªn Ä‘áº§y Ä‘á»§ (Vietnam)</small>
      </label>
      
      <hr class="divider" />
      
      <!-- LiÃªn há»‡ -->
      <div class="subsection-title">ğŸ“ ThÃ´ng tin liÃªn láº¡c</div>
      <div>
        <div class="radio-title">HÃ¬nh thá»©c liÃªn há»‡ Æ°u tiÃªn *</div>
        <div class="radio-group">
          <label><input type="radio" name="cfg_disconnectedPref" value="prefer_either" id="cfg_pref_either" checked> Gá»i hoáº·c email</label>
          <label><input type="radio" name="cfg_disconnectedPref" value="prefer_phone" id="cfg_pref_phone"> Gá»i Ä‘iá»‡n</label>
          <label><input type="radio" name="cfg_disconnectedPref" value="prefer_email" id="cfg_pref_email"> Gá»­i email</label>
        </div>
      </div>
      
      <label>
        MÃ£ quá»‘c gia Ä‘iá»‡n thoáº¡i
        <input id="cfg_phoneCountry" type="text" placeholder="VN" />
        <small style="color: #666; font-size: 11px;">ğŸ’¡ Nháº­p mÃ£ 2 kÃ½ tá»± (VN, US, etc.)</small>
      </label>
      <label>
        Sá»‘ Ä‘iá»‡n thoáº¡i
        <input id="cfg_phoneNumber" type="text" placeholder="0912345678" />
      </label>
      
      <div>
        <div class="radio-title">Loáº¡i Ä‘iá»‡n thoáº¡i</div>
        <div class="radio-group">
          <label><input type="radio" name="cfg_phoneType" value="1" id="cfg_phoneType_mobile"> Di Ä‘á»™ng</label>
          <label><input type="radio" name="cfg_phoneType" value="2" id="cfg_phoneType_landline"> Cá»‘ Ä‘á»‹nh</label>
        </div>
      </div>
      
      <label>
        Thá»i gian thuáº­n tiá»‡n gá»i láº¡i
        <input id="cfg_preferredTime" type="text" placeholder="09:00-17:00" />
      </label>
      
      <hr class="divider" />
      
      <!-- ATO/Hijacking -->
      <div class="subsection-title">ğŸ”’ Báº£o máº­t tÃ i khoáº£n</div>
      <div>
        <div class="radio-title">LiÃªn quan ATO/Hijacking?</div>
        <div class="radio-group">
          <label><input type="radio" name="cfg_atoOrHijacking" value="yes" id="cfg_ato_yes"> CÃ³</label>
          <label><input type="radio" name="cfg_atoOrHijacking" value="no" id="cfg_ato_no"> KhÃ´ng</label>
        </div>
      </div>
      <label>
        MÃ´ táº£ sá»± cá»‘ (náº¿u cÃ³ ATO)
        <select id="cfg_incidentDescription">
          <option value="">-- Chá»n --</option>
          <option value="suspect_account_hijacked">Nghi ngá» bá»‹ xÃ¢m nháº­p</option>
          <option value="unauthorized_changes_activity">PhÃ¡t hiá»‡n thay Ä‘á»•i trÃ¡i phÃ©p</option>
          <option value="account_suspended">TÃ i khoáº£n bá»‹ táº¡m ngÆ°ng do ATO</option>
          <option value="dispute_unauthorized_charges">KhÃ¡ng nghá»‹ phÃ­ trÃ¡i phÃ©p</option>
          <option value="general_questions">CÃ¢u há»i vá» sá»± cá»‘ báº£o máº­t</option>
        </select>
      </label>
      <label>
        Email quáº£n trá»‹ viÃªn *
        <input id="cfg_adminEmail" type="email" placeholder="admin@example.com" />
      </label>
      <label>
        NgÃ y xÃ¡c nháº­n chiáº¿m Ä‘oáº¡t
        <input id="cfg_accountCompromisedDate" type="date" placeholder="mm/dd/yyyy" />
      </label>
    
      <hr class="divider" />
      <div class="subsection-title">ğŸ“ TÃ³m táº¯t váº¥n Ä‘á»</div>
      <label>
        TÃ³m táº¯t váº¥n Ä‘á» * (tá»‘i Ä‘a 2000 kÃ½ tá»±)
        <textarea id="cfg_issueSummary" rows="4" maxlength="2000" placeholder="MÃ´ táº£ chi tiáº¿t váº¥n Ä‘á»..."></textarea>
      </label>
      
      <hr class="divider" />
        </div>
      </div>
    </details>
    <div style="display: flex; gap: 8px;">
      <button id="startButton" class="btn btn-primary" style="flex: 1;">â–¶ï¸ Báº®T Äáº¦U</button>
      <button id="stopButton" class="btn" style="flex: 0 0 auto; background: #dc3545; border-color: #dc3545; display: none;">â¹ï¸ Dá»ªNG</button>
    </div>
    <div id="status" class="status">Tráº¡ng thÃ¡i: Äang chá»...</div>
    <!-- <button type="button" id="saveConfigBtn" class="btn btn-primary" style="margin-top:8px;">ğŸ’¾ LÆ°u cáº¥u hÃ¬nh</button> -->
  </div>
  <script src="popup.js"></script>
 </body>
</html>